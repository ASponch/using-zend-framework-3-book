<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework 3">
<meta name="keywords" content="zend framework,book,free book,zend framework book,free zend framework book,zf3 book,free zf3 book,zend book,tutorial,zend framework tutorial">
<meta name="author" content="(c) 2016 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Controllers -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework 3            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="Separating_Business_Logic_from_Presentation.html">
            <img alt="Previous Chapter" src="../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="toc.html">
            <img alt="Contents" src="../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="Variable_Containers.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../assets/images/right.png">
        </a>
            </div>    
</div>

ï»¿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Book - Chapter - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="4531860323"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

<!-- Chapter content -->
<div id="chapter_content">

<h2 id="header-71">4.3. Controllers</h2>
<p>A controller provides communication between the application, models and views: 
gets input from HTTP request and uses the model(s) and the corresponding view 
to produce the necessary HTTP response.</p>
<p>Controllers belonging to module typically reside in the <code>Controller</code> subdirectory 
of module's source directory (shown in figure 4.3).</p>
<p><span class="image-wrapper">
<a target="_blank" href="images/mvc/controller_dir.png">
<img src="images/mvc/controller_dir.png" alt="Figure 4.3. Controller directory" /></a>
<span class="image-caption">Figure 4.3. Controller directory</span>
</span>
</p>
<p>Zend Skeleton Application provides you with the default implementation of <code>IndexController</code> 
class. The <code>IndexController</code> is typically the main controller class of the website. Its code 
is presented below (some parts of code were omitted for simplicity):  </p>
<pre class="line-numbers"><code class="language-php">&lt;?php
namespace Application\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;

class IndexController extends AbstractActionController
{
    public function indexAction()
    {
        return new ViewModel();
    }
}
</code></pre>
<p>From the example above, you can see that controllers usually define their own namespace (line 2). 
The Index controller, as all other controllers from the <em>Application</em> module, lives in <code>Application\Controller</code> 
namespace.</p>
<p>A controller is a usual PHP class derived from the <code>AbstractActionController</code> base class (line 7). </p>
<p>By default, the controller class contains the single <em>action method</em> called <code>indexAction()</code> (see lines 9-12).
Typically, you will create other action methods in your controller classes. </p>
<blockquote class="notquote tip" data-type="tip"><p> ZF3 automatically recognizes the action methods by the <code>Action</code> suffix. 
 If a controller method's name does not have that suffix, it is considered as a usual method, not an action.</p>
</blockquote><p>As its name assumes, an action method performs some site action, 
which typically results in producing a single web page. Index controller usually
contains action methods for site-wide web pages (table 4.1). For example, you would have 
"index" action for the <em>Home</em> page, "about" action for <em>About</em> page,
"contactUs" action for the <em>Contact Us</em> page and possibly other actions.</p>
<div class="table-wrapper">
<div class="table-caption">Table 4.1. Index controller's typical actions</div><table>
<thead>
<tr>
<th> <em>Action Method</em>                    </th>
<th> <em>Description</em>                                    </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>IndexController::indexAction()</code>                                        </td>
<td>  The "index" action displays the Home page of your  site.                                            </td>
</tr>
<tr>
<td> <code>IndexController::aboutAction()</code>                                                                             </td>
<td> The "about" action displays the About page of      the site. The About page contains contact and      copyright information.                           </td>
</tr>
<tr>
<td> <code>IndexController::contactUsAction()</code>                                                                          </td>
<td> The "contactUs" action displays the Contact Us     page of the site. The Contact Us page displays     the form for contacting site authors.            </td>
</tr>
</tbody>
</table>
</div>
<h3 id="header-72">4.3.1. Base Controller Class</h3>
<p>Every controller in your website is inherited from the <code>AbstractActionController</code> base class.
In figure 4.4, the class inheritance diagram is presented.</p>
<p><span class="image-wrapper">
<a target="_blank" href="images/mvc/controller_inheritance.png">
<img src="images/mvc/controller_inheritance.png" alt="Figure 4.4. Controller inheritance diagram" /></a>
<span class="image-caption">Figure 4.4. Controller inheritance diagram</span>
</span>
</p>
<p>The <code>AbstractActionController</code> provides you with several useful methods you can use
in your controller classes. Table 4.2 provides you with a brief summary of the methods:</p>
<div class="table-wrapper">
<div class="table-caption">Table 4.2. AbstractActionController's useful methods</div><table>
<thead>
<tr>
<th> <em>Method Name</em>                    </th>
<th> <em>Description</em>                                          </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>getRequest()</code>                                                      </td>
<td>  Retrieves the <code>Zend\Http\Request</code> object, which is the   representation of HTTP request data.                   </td>
</tr>
<tr>
<td> <code>getResponse()</code>                                                     </td>
<td> Retrieves the <code>Zend\Http\PhpEnvironment\Response</code> object  allowing to set data of HTTP response.                 </td>
</tr>
<tr>
<td> <code>getEventManager()</code>                                                 </td>
<td> Returns the <code>Zend\EventManager\EventManager</code> object,     allowing to trigger events and listen to events.       </td>
</tr>
<tr>
<td> <code>getEvent()</code>                                                        </td>
<td> Returns the <code>Zend\Mvc\MvcEvent</code> object, which represents  the event the controller responds to.                  </td>
</tr>
<tr>
<td> <code>getPluginManager()</code>                                                </td>
<td> Returns the <code>Zend\Mvc\Controller\PluginManager</code> object,  which can be used for registering controller plugins.  </td>
</tr>
<tr>
<td> <code>plugin($name, $options)</code>                                           </td>
<td> This method allows to access certain controller  plugin  with the given name.                                   </td>
</tr>
<tr>
<td> <code>__call($method, $params)</code>                                          </td>
<td> Allows to call a plugin indirectly using the PHP <code>__call</code>   magic method.                                          </td>
</tr>
</tbody>
</table>
</div>
<p>As you can see from the table above, the base controller class provides you with access to HTTP request
and response data, and provides you with the access to the event manager.
It also gives you an ability to register and call controller plugins (we will learn about controller
plugins later in this chapter).</p>
<h3 id="header-73">4.3.2. Retrieving Data from HTTP Request</h3>
<p>In a controller's action method, you may need to retrieve the data from the HTTP request 
(the data like GET and POST variables, cookies, HTTP headers and so on). For this purpose, Zend Framework 3 
provides you with <code>Zend\Http\Request</code> and <code>Zend\Http\PhpEnvironment\Response</code> classes, 
which are part of <code>Zend\Http</code> component.</p>
<p>To get the HTTP request object, inside of your action method, you can use the following code:</p>
<pre class=""><code class="language-php">// Get HTTP request object
$request = $this-&gt;getRequest();
</code></pre>
<p>The code above returns the instance of <code>Zend\Http\Request</code> class, containing all the HTTP 
request data. In table 4.3, you can find the most widely used methods of the <code>Request</code> class together 
with their brief description.</p>
<div class="table-wrapper">
<div class="table-caption">Table 4.3. Methods of `Zend\Http\Request` class.</div><table>
<thead>
<tr>
<th> Method Name                            </th>
<th> Description                                          </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>isGet()</code>                              </td>
<td>  Checks if this is a GET request.                     </td>
</tr>
<tr>
<td> <code>isPost()</code>                             </td>
<td> Checks if this is a POST request.                    </td>
</tr>
<tr>
<td> <code>isXmlHttpRequest()</code>                   </td>
<td> Checks if this request is an AJAX request.           </td>
</tr>
<tr>
<td> <code>isFlashRequest()</code>                     </td>
<td> Check if this request is a Flash request.            </td>
</tr>
<tr>
<td> <code>getMethod()</code>                          </td>
<td> Returns the method for this request.                 </td>
</tr>
<tr>
<td> <code>getUriString()</code>                       </td>
<td> Returns the URI for this request object as a string. </td>
</tr>
<tr>
<td> <code>getQuery($name, $default)</code>                                                     </td>
<td> Returns the query parameter by name, or all query parameters.   If a parameter is not found, returns the <code>$default</code> value.</td>
</tr>
<tr>
<td> <code>getPost($name, $default)</code>                                                      </td>
<td> Returns the parameter container responsible for post   parameters or a single post parameter.               </td>
</tr>
<tr>
<td> <code>getCookie()</code>                            </td>
<td> Returns the Cookie header.                            </td>
</tr>
<tr>
<td> <code>getFiles($name, $default)</code>                                                     </td>
<td> Returns the parameter container responsible for file   parameters or a single file.                         </td>
</tr>
<tr>
<td> <code>getHeaders($name, $default)</code>                                                   </td>
<td> Returns the header container responsible for headers   or all headers of a certain name/type.               </td>
</tr>
<tr>
<td> <code>getHeader($name, $default)</code>                                                    </td>
<td> Returns a header by <code>$name</code>. If a header is not found,     returns the <code>$default</code> value.                        </td>
</tr>
<tr>
<td> <code>renderRequestLine()</code>                                                           </td>
<td> Returns the formatted request line (first line) for    this HTTP request.                                   </td>
</tr>
<tr>
<td> <code>fromString($string)</code>                                                           </td>
<td> A static method that produces a Request object from a  well-formed Http Request string                      </td>
</tr>
<tr>
<td> <code>toString()</code>                           </td>
<td> Returns the raw HTTP request as a string.            </td>
</tr>
</tbody>
</table>
</div>
<h3 id="header-74">4.3.3. Retrieving GET or POST Variables</h3>
<p>To simply get a GET or POST variable from an HTTP request, you use the following code:</p>
<pre class="line-numbers"><code class="language-php">// Get a variable from GET
$getVar = $this-&gt;params()-&gt;fromQuery('var_name', 'default_val');

// Get a variable from POST
$postVar = $this-&gt;params()-&gt;fromPost('var_name', 'default_val');
</code></pre>
<p>In the example above, we used the <code>Params</code> controller plugin, which provides you with
convenient methods of accessing GET and POST variables, uploaded files, etc.</p>
<p>In line 2 we use the <code>fromQuery()</code> method for retrieving a variable having name "var_name" from GET.
If such a variable does not present, the default value "default_val" is returned.
The default value is very convenient, because you don't have to use the <code>isset()</code> PHP
function to test if the variable exists.</p>
<p>In line 5 we use the <code>fromPost()</code> method to retrieve the variable from POST. The meaning
of this method's parameters is the same as for the <code>fromQuery()</code> method.</p>
<blockquote class="notquote tip" data-type="tip"><p> In ZF3, you must not access request parameters through traditional PHP <code>$_GET</code> and <code>$_POST</code>
 global arrays. Instead, you use ZF3-provided API for retrieving the request data.</p>
</blockquote><h3 id="header-75">4.3.4. Putting Data to HTTP Response</h3>
<p>Although you typically do not interact with HTTP response data directly, you can do that
with the help of <code>getResponse()</code> method provided by <code>AbstractActionController</code> base class.
Table 4.4 contains the most important methods of the <code>Response</code> class:</p>
<div class="table-wrapper">
<div class="table-caption">Table 4.4. Methods of `Zend\Http\PhpEnvironment\Response` class.</div><table>
<thead>
<tr>
<th> Method Name                            </th>
<th> Description                                            </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>fromString($string)</code>                  </td>
<td>  Populate response object from string.                 </td>
</tr>
<tr>
<td> <code>getCookie()</code>                          </td>
<td> Retrieves Cookie header.                              </td>
</tr>
<tr>
<td> <code>setStatusCode($code)</code>                 </td>
<td> Sets HTTP status code and (optionally) message.        </td>
</tr>
<tr>
<td> <code>getStatusCode()</code>                      </td>
<td> Retrieves HTTP status code.                            </td>
</tr>
<tr>
<td> <code>setReasonPhrase($reasonPhrase)</code>       </td>
<td> Sets the HTTP status message.                         </td>
</tr>
<tr>
<td> <code>getReasonPhrase()</code>                    </td>
<td> Gets HTTP status message.                              </td>
</tr>
<tr>
<td> <code>getBody()</code>                            </td>
<td> Gets the body of the response.                         </td>
</tr>
<tr>
<td> <code>isForbidden()</code>                        </td>
<td> Checks if the response code is 403 Forbidden.         </td>
</tr>
<tr>
<td> <code>isNotFound()</code>                         </td>
<td> Checks if the status code indicates the resource is not found (404 status code). </td>
</tr>
<tr>
<td> <code>isOk()</code>                               </td>
<td> Checks whether the response is successful.          </td>
</tr>
<tr>
<td> <code>isServerError()</code>                      </td>
<td> Checks if the response is 5xx status code.           </td>
</tr>
<tr>
<td> <code>isRedirect()</code>                         </td>
<td> Checks whether the response is 303 Redirect.         </td>
</tr>
<tr>
<td> <code>isSuccess()</code>                          </td>
<td> Checks whether the response is 200 Successful.      </td>
</tr>
<tr>
<td> <code>renderStatusLine()</code>                   </td>
<td> Renders the status line header.                        </td>
</tr>
<tr>
<td> <code>toString()</code>                           </td>
<td> Renders entire response as HTTP response string.       </td>
</tr>
</tbody>
</table>
</div>
        
</div>

<!-- Ads -->
<div id="ads-chapter-bottom">
<div>
ï»¿<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Using Zend Framework 3 Chapter - Bottom - Adaptive -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3933778336056438"
     data-ad-slot="1546211126"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>
</div>
    
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="Separating_Business_Logic_from_Presentation.html">
            <img alt="Previous Chapter" src="../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="toc.html">
            <img alt="Contents" src="../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="Variable_Containers.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../assets/images/right.png">
        </a>
            </div>    
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2016 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a> on 2016-08-26 at 02:43            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/loadCSS.js"></script>

<script src="../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

