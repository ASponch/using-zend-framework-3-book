<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2016 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Combining Route Types -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../Routing/Route_Types.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Routing/Routing_Configuration.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../Routing.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Routing</span>
        </a>
    </div>
    </div>


<!-- Chapter content -->
<div id="chapter_content">

<h2 id="Combining_Route_Types">5.3. Combining Route Types</h2>
<p>Routes may be combined with the help of "aggregate" route types (shown in table 5.2).
The compound route types allow to define arbitrarily complex URL mapping rules.</p>
<div class="table-wrapper">
<div class="table-caption">Table 5.2. Aggregate Route Types</div><table>
<thead>
<tr>
<th> <em>Route Type</em>                   </th>
<th> <em>Description</em>                                                 </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <em>SimpleRouteStack</em>             </td>
<td>  Aggregates different route types in a list with priorities.   </td>
</tr>
<tr>
<td> <em>TreeRouteStack</em>               </td>
<td> Aggregates different route types in a tree-like structure.    </td>
</tr>
<tr>
<td> <em>Part</em>                         </td>
<td> Aggregates different route types in a subtree.                </td>
</tr>
<tr>
<td> <em>Chain</em>                        </td>
<td> Aggregates different route types in a chain (degenerated subtree). </td>
</tr>
</tbody>
</table>
</div>
<p>The <code>TreeRouteStack</code> and <code>SimpleRouteStack</code> are used as the "top-level" route types. 
The <em>SimpleRouteStack</em> allows to organize different routes in a priority list. 
The <em>TreeRouteStack</em> allows to <em>nest</em> different routes, forming a "tree". </p>
<p>Figure 5.2 shows the route class inheritance diagram. </p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/routing/route_inheritance.png">
<img src="../images/routing/route_inheritance.png" alt="Figure 5.2. Route class inheritance diagram" /></a>
<span class="image-caption">Figure 5.2. Route class inheritance diagram</span>
</span>
</p>
<p>As you can see from the image, all route classes are inherited from <code>RouteInterface</code> interface (we 
will learn this interface in details in the <em>Writing Own Route Type</em> section later in this 
chapter). The <code>SimpleRouteStack</code> is a parent class for <code>TreeRouteStack</code> class, which 
inherits the behavior of the simple route stack (allows to organize routes in priority list) and 
extends it (allows to organize routes in subtrees). The <code>Part</code> and <code>Chain</code> classes are 
derived from <code>TreeRouteStack</code> class and are used internally by the <code>TreeRouteStack</code> for building 
subtrees and chains of child routes. </p>
<h3 id="Simple_Route_Stack">5.3.1. Simple Route Stack</h3>
<p>The <code>SimpleRouteStack</code> allows to combine different routes in a priority list.
For an example of such a list, look at the route stack in the left part of figure 5.3.
The example list contains several <em>Literal</em> routes and several <em>Segment</em> routes.</p>
<p>When matching against the HTTP request, the <code>SimpleRouteStack</code> walks through the list
of routes and tries to match each route in turn. Each route in the list has a priority; 
the routes with the higher priority are visited first. The lookup is finished once some route matches
the HTTP request. If none of the routes match, the "not found" error is raised. </p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/routing/route_tree.png">
<img src="../images/routing/route_tree.png" alt="Figure 5.3. An example of Simple Route Stack (left) and Tree Route Stack (right)" /></a>
<span class="image-caption">Figure 5.3. An example of Simple Route Stack (left) and Tree Route Stack (right)</span>
</span>
</p>
<h3 id="Tree_Route_Stack">5.3.2. Tree Route Stack</h3>
<p>The <code>TreeRouteStack</code> class extends the <code>SimpleRouteStack</code> class, which means it can 
organize routes in a priority list, plus it provides an ability to nest routes in subtrees
and chains. An example tree route stack is presented in the right part of figure 5.3.
The list contains of one <code>Literal</code> route, a chain of <code>Literal</code> and <code>Segment</code> routes,
and a subtree consisting of two branches: a branch containing a single <code>Segment</code> route,
and a branch consisting of <code>Scheme</code>, <code>Hostname</code> and <code>Segment</code> routes. </p>
<p>The tree route stack performs request matching in the following way. It walks through
its priority list items (denoted by dashed lines in figure 5.3), starting from high-priority routes. If a certain item is
a <code>Chain</code> route or a <code>Part</code> route, it processes such a nested route from its parent route to children. 
If the parent route matches, the children (denoted with solid lines) are analyzed then. The nested route is considered matching
if at least one route matches in each tree (or chain) level.</p>
<p>Each route in a tree (or chain) consumes a part of the URL (figure 5.4). The parent route is matched against the
first part of the URL, its child is matched again 
the next part, and so on, until the end of the URL string
is reached.</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/routing/route_matching.png">
<img src="../images/routing/route_matching.png" alt="Figure 5.4. An example of nested route matching" /></a>
<span class="image-caption">Figure 5.4. An example of nested route matching</span>
</span>
</p>
        
</div>

    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../Routing.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">Routing</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../Routing/Route_Types.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../Routing/Routing_Configuration.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2016 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

