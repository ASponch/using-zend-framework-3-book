<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="description" content="A free and open-source book about Zend Framework">
<meta name="keywords" content="php,zend framework,book,tutorial,documentation,learn,free">
<meta name="author" content="(c) 2017 by Oleg Krivtsov">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="../../favicon.ico" rel="shortcut icon" type="image/ico" />
<link href="../../assets/css/style.css" type="text/css" rel="stylesheet" />
<title>Implementing User Authentication -- Using Zend Framework 3</title>
</head>
<body>
<header>
    <div class="header">
        <div class="header-body">
            <div class="book-title">
                <a href="../../index.html">Using Zend Framework 3</a>
            </div>
            <div class="book-subtitle">
                A free and open-source book about Zend Framework            </div>
            <nav>
                <div class="menu">
                                        <div class="link">
                        <a href="https://olegkrivtsov.github.io/using-zend-framework-3-book/html">Read</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zf3-book-samples">Samples</a>
                    </div>
                                        <div class="link">
                        <a href="https://github.com/olegkrivtsov/using-zend-framework-3-book">Contribute</a>
                    </div>
                    
                </div>
            </nav>
        </div>    
    </div>
</header>    
<div id="container">
<!-- Navigation -->
<div class="navigation">
    <div class="prev-chapter">
        
        <a href="../User_Management__Authentication_and_Access_Filtering/Adding_UserManager_Service.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../User_Management__Authentication_and_Access_Filtering/Access_Filtering.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>
        <div class="current-chapter">
        <a href="../User_Management__Authentication_and_Access_Filtering.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">User Management, Authentication and Access Filtering</span>
        </a>
    </div>
    </div>


<!-- Chapter content -->
<div id="chapter_content">

<h2 id="Implementing_User_Authentication">16.7. Implementing User Authentication</h2>
<p><em>Authentication</em> is the process when a user provides his login and password and you decide whether these credentials
are correct. Authentication typically means you check your database for the given login, and if such login exists, you
check if the hash calculated by the given password matches the hash of the password stored in the database.</p>
<blockquote class="notquote information" data-type="information"><p> You typically do not store raw passwords in database. Instead, you store a <em>hash</em> of the password. This is done for security reasons.</p>
</blockquote><p>Once the authentication algorithm determines that the login and password are correct, it returns user <em>identity</em> - a unique
ID of the user. The identity is typically stored to session, so the visitor doesn't need to pass authentication for every
HTTP request. </p>
<p>In ZF3, there is a special component allowing you to implement user authentication - <code>Zend\Authentication</code>.
You can install this component with Composer by typing the following command:</p>
<pre class=""><code class="language-text">php composer.phar require zendframework/zend-authentication
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> For authentication to work, you also need to have <code>Zend\Session</code> component installed and session manager configured. For information 
 on how to do that, refer to <a href="../Working_with_Sessions.html">Working with Sessions</a> chapter.</p>
</blockquote><h3 id="AuthenticationService">16.7.1. AuthenticationService</h3>
<p>The <code>Zend\Authentication</code> component provides the special service class called <code>AuthenticationService</code> living
in <code>Zend\Authentication</code> namespace. Most useful methods of this service are shown in table 16.1 below.</p>
<div class="table-wrapper">
<div class="table-caption">Table 16.1. Methods of AuthenticationService class</div><table>
<thead>
<tr>
<th> <em>Method</em>                       </th>
<th> <em>Description</em>                                                 </th>
</tr>
</thead>
<tbody>
<tr>
<td>  <code>authenticate()</code>               </td>
<td>  Performs user authentication using the adapter.               </td>
</tr>
<tr>
<td> <code>getAdapter()</code>                 </td>
<td> Gets authentication adapter.                                  </td>
</tr>
<tr>
<td> <code>setAdapter()</code>                 </td>
<td> Sets authentication adapter implementing the actual authentication algorithm. </td>
</tr>
<tr>
<td> <code>getStorage()</code>                 </td>
<td> Returns storage handler.                                      </td>
</tr>
<tr>
<td> <code>setStorage()</code>                 </td>
<td> Sets storage handler.                                         </td>
</tr>
<tr>
<td> <code>hasIdentity()</code>                </td>
<td> Returns <code>true</code> if user identity is already stored in session. </td>
</tr>
<tr>
<td> <code>getIdentity()</code>                </td>
<td> Retrieves user identity from session.                         </td>
</tr>
<tr>
<td> <code>clearIdentity()</code>              </td>
<td> Removes user identity from session.                           </td>
</tr>
</tbody>
</table>
</div>
<p>As you can see from the table, you can use the <code>authenticate()</code> method to perform user authentication.
Besides that you can use <code>hasIdentity()</code>, <code>getIdentity()</code> and <code>clearIdentity()</code> methods for testing,
retrieving and clearing user identity, respectively.</p>
<p>However, the <code>AuthenticationService</code> service is very 'generic' - it knows nothing about how
to actually match login and password against the database. It also knows nothing about how to save the user identity
to session. This design allows to implement any suitable authentication algorithm and any suitable storage. </p>
<p>The <code>Zend\Authentication</code> component provides several <em>authentication adapters</em> implementing some standard authentication 
algorithms (see figure 16.9), and several <em>storage handlers</em> allowing to save and retrieve the user identity (see figure 16.10).</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/users/std_auth_adapters.png">
<img src="../images/users/std_auth_adapters.png" alt="Figure 16.9 Standard authentication adapters" /></a>
<span class="image-caption">Figure 16.9 Standard authentication adapters</span>
</span>
</p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/users/std_auth_storage_handlers.png">
<img src="../images/users/std_auth_storage_handlers.png" alt="Figure 16.10 Standard storage handlers" /></a>
<span class="image-caption">Figure 16.10 Standard storage handlers</span>
</span>
</p>
<p>For our purposes, we can use <code>Session</code> storage handler without need of any code changes. However, standard authentication
adapters are not suitable for us, because we use Doctrine ORM. We will have to write our custom authentication adapter.
Luckily, this is rather simple to do.</p>
<h3 id="Writing_Authentication_Adapter">16.7.2. Writing Authentication Adapter</h3>
<p>An authentication adapter must implement <code>AdapterInterface</code> interface, which has the single method <code>authenticate()</code>.
This method should check the user email and password against database. We will do this as follows:</p>
<ul>
<li>Find the user with the given <code>email</code> (we think of E-mail address as of user's login).</li>
<li>If user with such <code>email</code> doesn't exist - return failure status.</li>
<li>Check the <code>status</code> of the user. If the user is "retired" - forbid the user to login.</li>
<li>Calculate password hash and compare it against the hash stored in database for the user found.</li>
<li>If password hash doesn't match, return failure status. </li>
<li>If password is correct, return success status.</li>
</ul>
<p>The <code>authenticate()</code> method returns an instance of the <code>Zend\Authentication\Result</code> class.
The <code>Result</code> class contains the authentication status, the error message and the user identity.</p>
<p>The adapter can also have additional methods. For example, we will add the <code>setEmail()</code> and <code>setPassword()</code> methods
that we will use to pass user email and password to the adapter.</p>
<p>To create the authentication adapter, add the file <em>AuthAdapter.php</em> to the <em>Service</em> directory of the module's source directory.</p>
<blockquote class="notquote information" data-type="information"><p> In the <em>User Demo</em> sample, we create a separate module called <em>User</em> and add functionality related to authentication
 and user management to that module.</p>
</blockquote><p>Put the following code into that file:</p>
<pre class=""><code class="language-php">&lt;?php
namespace User\Service;

use Zend\Authentication\Adapter\AdapterInterface;
use Zend\Authentication\Result;
use Zend\Crypt\Password\Bcrypt;
use User\Entity\User;

/**
 * Adapter used for authenticating user. It takes login and password on input
 * and checks the database if there is a user with such login (email) and password.
 * If such user exists, the service returns his identity (email). The identity
 * is saved to session and can be retrieved later with Identity view helper provided
 * by ZF3.
 */
class AuthAdapter implements AdapterInterface
{
    /**
     * User email.
     * @var string 
     */
    private $email;
    
    /**
     * Password
     * @var string 
     */
    private $password;
    
    /**
     * Entity manager.
     * @var Doctrine\ORM\EntityManager 
     */
    private $entityManager;
        
    /**
     * Constructor.
     */
    public function __construct($entityManager)
    {
        $this-&gt;entityManager = $entityManager;
    }
    
    /**
     * Sets user email.     
     */
    public function setEmail($email) 
    {
        $this-&gt;email = $email;        
    }
    
    /**
     * Sets password.     
     */
    public function setPassword($password) 
    {
        $this-&gt;password = (string)$password;        
    }
    
    /**
     * Performs an authentication attempt.
     */
    public function authenticate()
    {                
        // Check the database if there is a user with such email.
        $user = $this-&gt;entityManager-&gt;getRepository(User::class)
                -&gt;findOneByEmail($this-&gt;email);
        
        // If there is no such user, return 'Identity Not Found' status.
        if ($user == null) {
            return new Result(
                Result::FAILURE_IDENTITY_NOT_FOUND, 
                null, 
                ['Invalid credentials.']);        
        }   
        
        // If the user with such email exists, we need to check if it is active or retired.
        // Do not allow retired users to log in.
        if ($user-&gt;getStatus()==User::STATUS_RETIRED) {
            return new Result(
                Result::FAILURE, 
                null, 
                ['User is retired.']);        
        }
        
        // Now we need to calculate hash based on user-entered password and compare
        // it with the password hash stored in database.
        $bcrypt = new Bcrypt();
        $passwordHash = $user-&gt;getPassword();
        
        if ($bcrypt-&gt;verify($this-&gt;password, $passwordHash)) {
            // Great! The password hash matches. Return user identity (email) to be
            // saved in session for later use.
            return new Result(
                    Result::SUCCESS, 
                    $this-&gt;email, 
                    ['Authenticated successfully.']);        
        }             
        
        // If password check didn't pass return 'Invalid Credential' failure status.
        return new Result(
                Result::FAILURE_CREDENTIAL_INVALID, 
                null, 
                ['Invalid credentials.']);        
    }
}
</code></pre>
<h3 id="Creating_the_Factory_for_AuthenticationService">16.7.3. Creating the Factory for AuthenticationService</h3>
<p>Once we've implemented the adapter, we can actually create the <code>AuthenticationService</code>.
The ZF3's <code>AuthenticationService</code> should be registered in the service manager before you can use it.
First of all, we will create a factory for it. Add the <em>AuthenticationServiceFactory.php</em> file under the
<em>Service/Factory</em> directory and put the following code there:</p>
<pre class=""><code class="language-php">&lt;?php
namespace User\Service\Factory;

use Interop\Container\ContainerInterface;
use Zend\Authentication\AuthenticationService;
use Zend\ServiceManager\Factory\FactoryInterface;
use Zend\Session\SessionManager;
use Zend\Authentication\Storage\Session as SessionStorage;
use User\Service\AuthAdapter;

/**
 * The factory responsible for creating of authentication service.
 */
class AuthenticationServiceFactory implements FactoryInterface
{
    /**
     * This method creates the Zend\Authentication\AuthenticationService service 
     * and returns its instance. 
     */
    public function __invoke(ContainerInterface $container, 
                    $requestedName, array $options = null)
    {
        $sessionManager = $container-&gt;get(SessionManager::class);
        $authStorage = new SessionStorage('Zend_Auth', 'session', $sessionManager);
        $authAdapter = $container-&gt;get(AuthAdapter::class);

        // Create the service and inject dependencies into its constructor.
        return new AuthenticationService($authStorage, $authAdapter);
    }
}
</code></pre>
<p>In the factory we do the following. First, we create an instance of the session manager (you should have 
set up the session manager already) and create an instance of <code>Session</code> storage handler. Then we create
an instance of <code>AuthAdapter</code>. Finally, we instantiate the <code>AuthenticationService</code> and inject dependencies 
(storage handler and adapter) into it.</p>
<p>Register the <code>AuthenticationService</code> in your <em>module.config.php</em> config file as follows:</p>
<pre class=""><code class="language-php">&lt;?php 
return [
    'service_manager' =&gt; [
        'factories' =&gt; [
            \Zend\Authentication\AuthenticationService::class 
                =&gt; Service\Factory\AuthenticationServiceFactory::class,
            // ...
        ],
    ],
];
</code></pre>
<h3 id="Adding_AuthController">16.7.4. Adding AuthController</h3>
<p>The <code>AuthController</code> class will have two actions:</p>
<ul>
<li><p>The <code>loginAction()</code> will allow to log in to the website (see figures 16.11 and 16.12).
You can access this page by typing "http://localhost/login" URL into your web browser's navigation bar.</p>
</li>
<li><p>The <code>logoutAction()</code> will allow to log out from the website.
You can access this page by typing "http://localhost/logout" URL into your web browser's navigation bar.</p>
</li>
</ul>
<p><span class="image-wrapper">
<a target="_blank" href="../images/users/login_page.png">
<img src="../images/users/login_page.png" alt="Figure 16.11 Login page" /></a>
<span class="image-caption">Figure 16.11 Login page</span>
</span>
 </p>
<p><span class="image-wrapper">
<a target="_blank" href="../images/users/login_page_errors.png">
<img src="../images/users/login_page_errors.png" alt="Figure 16.12 Login page - Invalid Credentials" /></a>
<span class="image-caption">Figure 16.12 Login page - Invalid Credentials</span>
</span>
     </p>
<p>The code of the <code>AuthController</code> controller class is presented below:</p>
<pre class=""><code class="language-php">&lt;?php

namespace User\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;
use Zend\Authentication\Result;
use Zend\Uri\Uri;
use User\Form\LoginForm;
use User\Entity\User;

/**
 * This controller is responsible for letting the user to log in and log out.
 */
class AuthController extends AbstractActionController
{
    /**
     * Entity manager.
     * @var Doctrine\ORM\EntityManager 
     */
    private $entityManager;
    
    /**
     * Auth manager.
     * @var User\Service\AuthManager 
     */
    private $authManager;
    
    /**
     * Auth service.
     * @var \Zend\Authentication\AuthenticationService
     */
    private $authService;
    
    /**
     * User manager.
     * @var User\Service\UserManager
     */
    private $userManager;
    
    /**
     * Constructor.
     */
    public function __construct($entityManager, $authManager, $authService, $userManager)
    {
        $this-&gt;entityManager = $entityManager;
        $this-&gt;authManager = $authManager;
        $this-&gt;authService = $authService;
        $this-&gt;userManager = $userManager;
    }
    
    /**
     * Authenticates user given email address and password credentials.     
     */
    public function loginAction()
    {
        // Retrieve the redirect URL (if passed). We will redirect the user to this
        // URL after successfull login.
        $redirectUrl = (string)$this-&gt;params()-&gt;fromQuery('redirectUrl', '');
        if (strlen($redirectUrl)&gt;2048) {
            throw new \Exception("Too long redirectUrl argument passed");
        }
        
        // Check if we do not have users in database at all. If so, create 
        // the 'Admin' user.
        $this-&gt;userManager-&gt;createAdminUserIfNotExists();
        
        // Create login form
        $form = new LoginForm(); 
        $form-&gt;get('redirect_url')-&gt;setValue($redirectUrl);
        
        // Store login status.
        $isLoginError = false;
        
        // Check if user has submitted the form
        if ($this-&gt;getRequest()-&gt;isPost()) {
            
            // Fill in the form with POST data
            $data = $this-&gt;params()-&gt;fromPost();            
            
            $form-&gt;setData($data);
            
            // Validate form
            if($form-&gt;isValid()) {
                
                // Get filtered and validated data
                $data = $form-&gt;getData();
                
                // Perform login attempt.
                $result = $this-&gt;authManager-&gt;login($data['email'], 
                        $data['password'], $data['remember_me']);
                
                // Check result.
                if ($result-&gt;getCode() == Result::SUCCESS) {
                    
                    // Get redirect URL.
                    $redirectUrl = $this-&gt;params()-&gt;fromPost('redirect_url', '');
                    
                    if (!empty($redirectUrl)) {
                        // The below check is to prevent possible redirect attack 
                        // (if someone tries to redirect user to another domain).
                        $uri = new Uri($redirectUrl);
                        if (!$uri-&gt;isValid() || $uri-&gt;getHost()!=null)
                            throw new \Exception('Incorrect redirect URL: ' . $redirectUrl);
                    }

                    // If redirect URL is provided, redirect the user to that URL;
                    // otherwise redirect to Home page.
                    if(empty($redirectUrl)) {
                        return $this-&gt;redirect()-&gt;toRoute('home');
                    } else {
                        $this-&gt;redirect()-&gt;toUrl($redirectUrl);
                    }
                } else {
                    $isLoginError = true;
                }                
            } else {
                $isLoginError = true;
            }           
        } 
        
        return new ViewModel([
            'form' =&gt; $form,
            'isLoginError' =&gt; $isLoginError,
            'redirectUrl' =&gt; $redirectUrl
        ]);
    }
    
    /**
     * The "logout" action performs logout operation.
     */
    public function logoutAction() 
    {        
        $this-&gt;authManager-&gt;logout();
        
        return $this-&gt;redirect()-&gt;toRoute('login');
    }
}
</code></pre>
<p>The <code>loginAction()</code> method accepts the <code>redirectUrl</code> GET parameter. The "redirect URL" is a convenience
feature working in pair with the <em>access filter</em> that we will describe later in this chapter. When the site 
visitor tries to access a web page the access filter forbids to access to unauthorized users, he/she is redirected
to the "Login" page, passing the URL of the original page as the "redirect URL". When the user logs in, he/she
is redirected back to the original page automatically, so improving user experience.</p>
<h3 id="Adding_View_Template_for_Login_Page">16.7.5. Adding View Template for Login Page</h3>
<p>The view template (<em>.phtml</em> file) for our <em>Login</em> page looks as follows:</p>
<pre class=""><code class="language-php">&lt;?php
$this-&gt;headTitle('Sign in');

$this-&gt;mainMenu()-&gt;setActiveItemId('login');

$form-&gt;get('email')-&gt;setAttributes([
    'class'=&gt;'form-control', 
    'placeholder'=&gt;'Email address',
    'required' =&gt; true,
    'autofocus' =&gt; true
    ])
    -&gt;setLabelAttributes([
        'class' =&gt; 'sr-only'
    ]);

$form-&gt;get('password')-&gt;setAttributes([
    'class'=&gt;'form-control', 
    'placeholder'=&gt;'Password',
    'required' =&gt; true,
    ])
    -&gt;setLabelAttributes([
        'class' =&gt; 'sr-only'
    ]);
?&gt;

&lt;div class="row"&gt;
    &lt;div class="col-md-offset-4 col-md-3"&gt;
        &lt;form class="form-signin" method="post"&gt;
            &lt;h2 class="form-signin-heading"&gt;Please sign in&lt;/h2&gt;
            &lt;?php if ($isLoginError): ?&gt;
            &lt;div class="alert alert-warning" role="alert"&gt;
                Incorrect login and/or password. 
                &lt;a href="&lt;?= $this-&gt;url('reset-password') ?&gt;"&gt;Forgot password?&lt;/a&gt;
            &lt;/div&gt;
            &lt;?php endif; ?&gt;
            &lt;?= $this-&gt;formLabel($form-&gt;get('email')); ?&gt;
            &lt;?= $this-&gt;formElement($form-&gt;get('email')); ?&gt;
            &lt;?= $this-&gt;formLabel($form-&gt;get('password')); ?&gt;
            &lt;?= $this-&gt;formElement($form-&gt;get('password')); ?&gt;
            &lt;div class="checkbox"&gt;
                &lt;label&gt;
                    &lt;?= $this-&gt;formElement($form-&gt;get('remember_me')); ?&gt; Remember me
                &lt;/label&gt;
            &lt;/div&gt;
            &lt;?= $this-&gt;formElement($form-&gt;get('redirect_url')); ?&gt;
            &lt;?= $this-&gt;formElement($form-&gt;get('csrf')) ?&gt;
            &lt;button class="btn btn-lg btn-primary btn-block" type="submit"&gt;Sign in&lt;/button&gt;
        &lt;/form&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<blockquote class="notquote tip" data-type="tip"><p> The view template uses the <em>Sign In</em> page template provided by Bootstrap CSS Framework.
 You can find the original template <a href="https://getbootstrap.com/examples/signin/">here</a>.</p>
</blockquote><h3 id="Adding_AuthManager_Service">16.7.6. Adding AuthManager Service</h3>
<p>The <code>AuthController</code> works in pair with the <code>AuthManager</code> service. The main business logic behind the authentication
is implemented in the service. Let's describe the <code>AuthManager</code> in details.</p>
<p>The <code>AuthManager</code> service has the following methods responsible for authentication:</p>
<ul>
<li>the <code>login()</code> method</li>
<li>the <code>logout()</code> method.</li>
</ul>
<p>The <code>login()</code> method (see below) uses the ZF3's <code>AuthenticationService</code> and the <code>AuthAdapter</code> we wrote earlier
for performing user authentication. The method additionally accepts the <code>$rememberMe</code> argument which
allows to extend the session cookie life time up to 30 days.  </p>
<pre class=""><code class="language-php">/**
 * Performs a login attempt. If $rememberMe argument is true, it forces the session
 * to last for one month (otherwise the session expires on one hour).
 */
public function login($email, $password, $rememberMe)
{   
    // Check if user has already logged in. If so, do not allow to log in 
    // twice.
    if ($this-&gt;authService-&gt;getIdentity()!=null) {
        throw new \Exception('Already logged in');
    }
        
    // Authenticate with login/password.
    $authAdapter = $this-&gt;authService-&gt;getAdapter();
    $authAdapter-&gt;setEmail($email);
    $authAdapter-&gt;setPassword($password);
    $result = $this-&gt;authService-&gt;authenticate();

    // If user wants to "remember him", we will make session to expire in 
    // one month. By default session expires in 1 hour (as specified in our 
    // config/global.php file).
    if ($result-&gt;getCode()==Result::SUCCESS &amp;&amp; $rememberMe) {
        // Session cookie will expire in 1 month (30 days).
        $this-&gt;sessionManager-&gt;rememberMe(60*60*24*30);
    }
    
    return $result;
}
</code></pre>
<p>The <code>logout()</code> method removes the user identity from session, so the visitor becomes unauthorized.</p>
<pre class=""><code class="language-php">/**
 * Performs user logout.
 */
public function logout()
{
    // Allow to log out only when user is logged in.
    if ($this-&gt;authService-&gt;getIdentity()==null) {
        throw new \Exception('The user is not logged in');
    }
    
    // Remove identity from session.
    $this-&gt;authService-&gt;clearIdentity();               
}
</code></pre>
        
</div>

    
<!-- Navigation -->
<div class="navigation">
        <div class="current-chapter">
        <a href="../User_Management__Authentication_and_Access_Filtering.html">
            <img alt="Contents" src="../../assets/images/upload.png"><span class="nav-btn-text">User Management, Authentication and Access Filtering</span>
        </a>
    </div>
        <div class="prev-chapter">
        
        <a href="../User_Management__Authentication_and_Access_Filtering/Adding_UserManager_Service.html">
            <img alt="Previous Chapter" src="../../assets/images/left.png"><span class="nav-btn-text">Previous</span>
        </a>
        </div>    
    <div class="contents">
        <a href="../toc.html">
            <img alt="Contents" src="../../assets/images/book.png"><span class="nav-btn-text">Contents</span>
        </a>
    </div>
    <div class="next-chapter">
                <a href="../User_Management__Authentication_and_Access_Filtering/Access_Filtering.html">
            <span class="nav-btn-text">Next</span><img alt="Next Chapter" src="../../assets/images/right.png">
        </a>
            </div>        
</div>

<div id="disqus_thread"></div>

        
</div>
<footer>
    <div class="footer">
        <div class="footer-body">
            <div class="copyright">
                Copyright (c) 2017 by Oleg Krivtsov            </div>
            <div class="generated-by">
                Generated using <a href="https://github.com/olegkrivtsov/openbook">OpenBook</a>
            </div>
        </div>    
    </div>
</footer>

<a href="#0" class="cd-top">Top</a>

<script src="../../assets/js/jquery.min.js"></script>
<script src="../../assets/js/loadCSS.js"></script>

<script src="../../assets/js/prism.js"></script>

<script>
var disqus_config = function () {
this.page.url = window.location.href; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = ''; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//using-zend-framework-3-book.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script>
loadCSS("../../assets/css/prism.css");
</script>

<script>
jQuery(document).ready(function($){
    // browser window scroll (in pixels) after which the "back to top" link is shown
    var offset = 300,
    //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
    offset_opacity = 1200,
    //duration of the top scrolling animation (in ms)
    scroll_top_duration = 700,
    //grab the "back to top" link
    $back_to_top = $('.cd-top');

    //hide or show the "back to top" link
    $(window).scroll(function(){
            ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
            if( $(this).scrollTop() > offset_opacity ) { 
                    $back_to_top.addClass('cd-fade-out');
            }
    });

    //smooth scroll to top
    $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
                    scrollTop: 0 ,
                    }, scroll_top_duration
            );
    });

});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-80824388-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>    

